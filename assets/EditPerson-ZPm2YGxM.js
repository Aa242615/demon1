/* empty css             *//* empty css                  */import{x as E,r as m,M as S,y as q,o as I,d as v,e as _,g as t,f as P,X as A,q as u,Y as d,m as k,E as B,A as M,B as T,_ as F}from"./index-p5a6JA3W.js";import{a as y}from"./axios-B4uVmeYG.js";const r=i=>(M("data-v-f792280c"),i=i(),T(),i),N={class:"container"},$={class:"flex items-center"},z=r(()=>t("span",{class:"edit-avatar-hint"},"点击头像以编辑",-1)),L={class:"form-container"},R={class:"form-group"},X=r(()=>t("label",{for:"account"},"账号",-1)),Y={class:"form-group"},j=r(()=>t("label",{for:"password"},"密码",-1)),G={class:"form-group"},H=r(()=>t("label",{for:"email"},"邮箱",-1)),J=["readonly"],K={class:"form-group"},O=r(()=>t("label",{for:"phone"},"手机号",-1)),Q=["readonly"],W={class:"form-group"},Z=r(()=>t("label",{for:"token"},"百度秘钥token",-1)),ee=["readonly"],ae={class:"form-group"},te=r(()=>t("label",{for:"nickname"},"昵称",-1)),oe=["readonly"],se={key:2,type:"submit"},ne=E({__name:"EditPerson",setup(i){const n={account:"默认账号",password:"默认密码",email:"example@example.com",phone:"1234567890",token:"默认Token",pet_name:"默认展示昵称",avatar:"https://cube.elemecdn.com/0/88/03b0d39583f48206768a7534e55bcpng.png"},a=m({account:n.account,password:n.password,email:n.email,phone:n.phone,token:n.token,nickname:n.pet_name}),f=m(n.avatar),l=m(!1),g=S(),w=q(),c=m(null),h=async()=>{try{console.log("访问个人信息展示界面，更新数据");const s=await y.post("http://127.0.0.1:5000/personal_page",{user:g.token.access_token});if(s.data.success==="true"&&s.data.data.length>0){const e=s.data.data[0];a.value.account=e.account??n.account,a.value.password=e.password??n.password,a.value.email=e.email??n.email,a.value.phone=e.phone??n.phone,a.value.token=e.token??n.token,a.value.nickname=e.pet_name??n.pet_name,f.value=e.avatar??n.avatar}else alert(`获取数据失败: ${s.data.message}`)}catch(s){alert("发生错误: "+(s.message||"未知错误"))}},b=async()=>{try{console.log("更新用户信息");const s={account:a.value.account,email:a.value.email,phone:a.value.phone,token:a.value.token,pet_name:a.value.nickname},e=await y.post("http://127.0.0.1:5000/person_page_show",s);e.data.success==="true"?(alert("用户信息更新成功"),l.value=!1,await h()):alert(`更新数据失败: ${e.data.message}`)}catch(s){alert("发生错误: "+(s.message||"未知错误"))}},x=async()=>{var p;if(!c.value||!((p=c.value.files)!=null&&p.length))return;const s=c.value.files[0],e=new FormData;e.append("avatar",s),e.append("user",g.token.access_token);try{const o=await y.post("http://127.0.0.1:5000/upload_avatar",e,{headers:{"Content-Type":"multipart/form-data"}});o.data.success==="true"?(alert("头像上传成功"),f.value=o.data.avatar_url,w.setAvatarUrl(o.data.avatar_url),console.log("头像 URL 更新为：",o.data.avatar_url)):alert(`头像上传失败: ${o.data.message}`)}catch(o){alert("发生错误: "+(o.message||"未知错误"))}},U=()=>{var s;(s=c.value)==null||s.click()},V=()=>{l.value=!0},C=()=>{l.value=!1,h()},D=()=>{b()};return I(()=>{h()}),(s,e)=>{const p=B;return v(),_("div",N,[t("div",$,[P(p,{class:"mr-3",size:250,src:f.value,onClick:U},null,8,["src"]),z,t("input",{type:"file",ref_key:"fileInput",ref:c,onChange:x,style:{display:"none"}},null,544),t("div",L,[t("form",{onSubmit:A(D,["prevent"])},[t("div",R,[X,u(t("input",{id:"account","onUpdate:modelValue":e[0]||(e[0]=o=>a.value.account=o),type:"text",readonly:"",required:""},null,512),[[d,a.value.account]])]),t("div",Y,[j,u(t("input",{id:"password","onUpdate:modelValue":e[1]||(e[1]=o=>a.value.password=o),type:"password",readonly:"",required:""},null,512),[[d,a.value.password]])]),t("div",G,[H,u(t("input",{id:"email","onUpdate:modelValue":e[2]||(e[2]=o=>a.value.email=o),type:"email",readonly:!l.value,required:""},null,8,J),[[d,a.value.email]])]),t("div",K,[O,u(t("input",{id:"phone","onUpdate:modelValue":e[3]||(e[3]=o=>a.value.phone=o),type:"tel",readonly:!l.value,required:""},null,8,Q),[[d,a.value.phone]])]),t("div",W,[Z,u(t("input",{id:"token","onUpdate:modelValue":e[4]||(e[4]=o=>a.value.token=o),type:"text",readonly:!l.value,required:""},null,8,ee),[[d,a.value.token]])]),t("div",ae,[te,u(t("input",{id:"nickname","onUpdate:modelValue":e[5]||(e[5]=o=>a.value.nickname=o),type:"text",readonly:!l.value,required:""},null,8,oe),[[d,a.value.nickname]])]),l.value?k("",!0):(v(),_("button",{key:0,type:"button",onClick:V},"编辑")),l.value?(v(),_("button",{key:1,type:"button",onClick:C},"取消修改")):k("",!0),l.value?(v(),_("button",se,"保存修改")):k("",!0)],32)])])])}}}),ce=F(ne,[["__scopeId","data-v-f792280c"]]);export{ce as default};
